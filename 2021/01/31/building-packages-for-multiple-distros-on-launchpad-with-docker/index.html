<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Building packages for multiple distros on launchpad with docker | Chmouel's blog</title><meta name=keywords content><meta name=description content="I have been trying to build some packages for the ubuntu distros for a new program I have released, gnome-next-meeting-applet
In short, it what quite painful! if you are quite new to the launchpad and debian packaging ways (which I wasn&rsquo;t and yet It took me some time to figure out) you can get quite lost. I got to say that the fedora copr experience is much smoother. After a couple of frustrated google and stackoverflow searches and multiple tries I finally figured out a script that builds and upload properly to launchpad via docker to make it available to my users."><meta name=author content><link rel=canonical href=https://blog.chmouel.com/2021/01/31/building-packages-for-multiple-distros-on-launchpad-with-docker/><link crossorigin=anonymous href=/assets/css/stylesheet.min.e5eb1d13ce3fd1cc61714e6c27f1a0e3177dfdae9524c57cf928c67ef61fc2b0.css integrity="sha256-5esdE84/0cxhcU5sJ/Gg4xd9/a6VJMV8+SjGfvYfwrA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.chmouel.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chmouel.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chmouel.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chmouel.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.chmouel.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Building packages for multiple distros on launchpad with docker"><meta property="og:description" content="I have been trying to build some packages for the ubuntu distros for a new program I have released, gnome-next-meeting-applet
In short, it what quite painful! if you are quite new to the launchpad and debian packaging ways (which I wasn&rsquo;t and yet It took me some time to figure out) you can get quite lost. I got to say that the fedora copr experience is much smoother. After a couple of frustrated google and stackoverflow searches and multiple tries I finally figured out a script that builds and upload properly to launchpad via docker to make it available to my users."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chmouel.com/2021/01/31/building-packages-for-multiple-distros-on-launchpad-with-docker/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-31T15:59:43+00:00"><meta property="article:modified_time" content="2021-01-31T15:59:43+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building packages for multiple distros on launchpad with docker"><meta name=twitter:description content="I have been trying to build some packages for the ubuntu distros for a new program I have released, gnome-next-meeting-applet
In short, it what quite painful! if you are quite new to the launchpad and debian packaging ways (which I wasn&rsquo;t and yet It took me some time to figure out) you can get quite lost. I got to say that the fedora copr experience is much smoother. After a couple of frustrated google and stackoverflow searches and multiple tries I finally figured out a script that builds and upload properly to launchpad via docker to make it available to my users."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chmouel.com/posts/"},{"@type":"ListItem","position":2,"name":"Building packages for multiple distros on launchpad with docker","item":"https://blog.chmouel.com/2021/01/31/building-packages-for-multiple-distros-on-launchpad-with-docker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Building packages for multiple distros on launchpad with docker","name":"Building packages for multiple distros on launchpad with docker","description":"I have been trying to build some packages for the ubuntu distros for a new program I have released, gnome-next-meeting-applet\nIn short, it what quite painful! if you are quite new to the launchpad and debian packaging ways (which I wasn\u0026rsquo;t and yet It took me some time to figure out) you can get quite lost. I got to say that the fedora copr experience is much smoother. After a couple of frustrated google and stackoverflow searches and multiple tries I finally figured out a script that builds and upload properly to launchpad via docker to make it available to my users.","keywords":[],"articleBody":"I have been trying to build some packages for the ubuntu distros for a new program I have released, gnome-next-meeting-applet\nIn short, it what quite painful! if you are quite new to the launchpad and debian packaging ways (which I wasn’t and yet It took me some time to figure out) you can get quite lost. I got to say that the fedora copr experience is much smoother. After a couple of frustrated google and stackoverflow searches and multiple tries I finally figured out a script that builds and upload properly to launchpad via docker to make it available to my users.\n The first rule of uploading to launchpad it’s to properly setup your GPG key on your account making sure it match what you have locally. The second rule is making sure the new upload you make increase onto the precedent uloaded version or it will be rejected. The third rule is to be patient or work on week-end, because the queue can be quite slow.  Now the magic is happening in this script :\nhttps://github.com/chmouel/gnome-next-meeting-applet/blob/742dbe48795c0151411db69065fdd773762100e1/debian/build.sh#L20-L41\nWe have a Dockerfile with all the dependencies we need for building the package in this file :\nhttps://github.com/chmouel/gnome-next-meeting-applet/blob/a2785314365c51200935ad63c38f490c597989c9/debian/Dockerfile\nWhen we launch the script in the main loop we modify the FROM to go to the distro docker tag targeted (here I have LTS and ROLLING) and we start the container build.\nWhen it’s done we mount our current source as a volume inside the container and mount our ~/.gnupg to the build user gnupg inside the container.\nWith dchwe increase the targeted distro version and we add as well after the release number the distro target after the \"~\" like this “0.1.0-1~focal1”.\nWe finish the upload with dput and launchpad *should* then send you an email it was accepted.\nAfter waiting a bit your package should be built for the multiple distribution.\n","wordCount":"310","inLanguage":"en","datePublished":"2021-01-31T15:59:43Z","dateModified":"2021-01-31T15:59:43Z","author":{"@type":"Person","name":"chmouel"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chmouel.com/2021/01/31/building-packages-for-multiple-distros-on-launchpad-with-docker/"},"publisher":{"@type":"Organization","name":"Chmouel's blog","logo":{"@type":"ImageObject","url":"https://blog.chmouel.com/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.chmouel.com/ accesskey=h title="Chmouel's blog (Alt + H)">Chmouel's blog</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://github.com/chmouel/ title=Github><span>Github</span></a></li><li><a href=https://photos.chmouel.com title=Photos><span>Photos</span></a></li><li><a href=https://app.strava.com/athletes/126695 title=Strava><span>Strava</span></a></li><li><a href=https://twitter.com/chmouel title=Twitter><span>Twitter</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Building packages for multiple distros on launchpad with docker</h1><div class=post-meta><span title="2021-01-31 15:59:43 +0000 UTC">January 31, 2021</span>&nbsp;|&nbsp;<a href=https://github.com/chmouel/blog/tree/main/content/posts/2021-01-31-building-packages-for-multiple-distros-on-launchpad-with-docker.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=post-content><p>I have been trying to build some packages for the ubuntu distros for a new program I have released, <a href=https://github.com/chmouel/gnome-next-meeting-applet>gnome-next-meeting-applet</a></p><p>In short, it what quite painful! if you are quite new to the launchpad and debian packaging ways (which I wasn&rsquo;t and yet It took me some time to figure out) you can get quite lost. I got to say that the <a href=https://copr.fedorainfracloud.org/>fedora copr</a> experience is much smoother. After a couple of frustrated google and stackoverflow searches and multiple tries I finally figured out a script that builds and upload properly to <a href=http://launchpad.net>launchpad</a> via docker to make it available to my users.</p><ol><li>The first rule of uploading to launchpad it&rsquo;s to properly setup your GPG key on your account making sure it match what you have locally.</li><li>The second rule is making sure the new upload you make increase onto the precedent uloaded version or it will be rejected.</li><li>The third rule is to be patient or work on week-end, because the queue can be quite slow.</li></ol><p>Now the magic is happening in this script :</p><p><a href=https://github.com/chmouel/gnome-next-meeting-applet/blob/742dbe48795c0151411db69065fdd773762100e1/debian/build.sh#L20-L41>https://github.com/chmouel/gnome-next-meeting-applet/blob/742dbe48795c0151411db69065fdd773762100e1/debian/build.sh#L20-L41</a></p><p>We have a <strong><a href=https://github.com/chmouel/gnome-next-meeting-applet/blob/a2785314365c51200935ad63c38f490c597989c9/debian/Dockerfile>Dockerfile</a></strong> with all the dependencies we need for building the package in this file :</p><p><a href=https://github.com/chmouel/gnome-next-meeting-applet/blob/a2785314365c51200935ad63c38f490c597989c9/debian/Dockerfile>https://github.com/chmouel/gnome-next-meeting-applet/blob/a2785314365c51200935ad63c38f490c597989c9/debian/Dockerfile</a></p><p>When we launch the script in the main loop we modify the FROM to go to the distro docker tag targeted (here I have LTS and ROLLING) and we start the container build.</p><p>When it&rsquo;s done we mount our current source as a volume inside the container and mount our ~/.gnupg to the build user gnupg inside the container.</p><p>With dch we increase the targeted distro version and we add as well after the release number the distro target after the <em>"~"</em> like this <em>&ldquo;0.1.0-1~focal1&rdquo;</em>.</p><p>We finish the upload with <a href=https://manpages.debian.org/stretch/dput-ng/dput.1.en.html>dput</a> and launchpad *should* then send you an email it was accepted.</p><p>After waiting a bit your package should be built for the multiple distribution.</p><p><img loading=lazy src=/wp-content/uploads/2021/01/image.png alt></p></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.chmouel.com/>Chmouel's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>