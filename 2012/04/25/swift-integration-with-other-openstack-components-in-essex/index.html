<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Swift integration with other OpenStack components in Essex. | Chmouel's blog</title><meta name=keywords content="Openstack"><meta name=description content="During the development for OpenStack Essex a lot of work has been done to make Swift working well with the other OpenStack components, this is a list of the work that has been done.
MIDDLEWARE To make Swift behaving well in the &lsquo;stack&rsquo; we had to get a rock solid keystone middleware and make sure most of the features provided by Swift would be supported by the middleware.
The middleware is currently locatedin the keystone essex repository and was entirely rewritten from the Diablo release to allow support these Swift features :"><meta name=author content><link rel=canonical href=https://blog.chmouel.com/2012/04/25/swift-integration-with-other-openstack-components-in-essex/><link crossorigin=anonymous href=/assets/css/stylesheet.min.5a5d567b690246c4eb15b9f0c3d47bef28df71173b90a626c03708a628d3193d.css integrity="sha256-Wl1We2kCRsTrFbnww9R77yjfcRc7kKYmwDcIpijTGT0=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.chmouel.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chmouel.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chmouel.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chmouel.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.chmouel.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Swift integration with other OpenStack components in Essex."><meta property="og:description" content="During the development for OpenStack Essex a lot of work has been done to make Swift working well with the other OpenStack components, this is a list of the work that has been done.
MIDDLEWARE To make Swift behaving well in the &lsquo;stack&rsquo; we had to get a rock solid keystone middleware and make sure most of the features provided by Swift would be supported by the middleware.
The middleware is currently locatedin the keystone essex repository and was entirely rewritten from the Diablo release to allow support these Swift features :"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chmouel.com/2012/04/25/swift-integration-with-other-openstack-components-in-essex/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2012-04-25T15:11:58+00:00"><meta property="article:modified_time" content="2012-04-25T15:11:58+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Swift integration with other OpenStack components in Essex."><meta name=twitter:description content="During the development for OpenStack Essex a lot of work has been done to make Swift working well with the other OpenStack components, this is a list of the work that has been done.
MIDDLEWARE To make Swift behaving well in the &lsquo;stack&rsquo; we had to get a rock solid keystone middleware and make sure most of the features provided by Swift would be supported by the middleware.
The middleware is currently locatedin the keystone essex repository and was entirely rewritten from the Diablo release to allow support these Swift features :"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chmouel.com/posts/"},{"@type":"ListItem","position":2,"name":"Swift integration with other OpenStack components in Essex.","item":"https://blog.chmouel.com/2012/04/25/swift-integration-with-other-openstack-components-in-essex/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Swift integration with other OpenStack components in Essex.","name":"Swift integration with other OpenStack components in Essex.","description":"During the development for OpenStack Essex a lot of work has been done to make Swift working well with the other OpenStack components, this is a list of the work that has been done.\nMIDDLEWARE To make Swift behaving well in the \u0026lsquo;stack\u0026rsquo; we had to get a rock solid keystone middleware and make sure most of the features provided by Swift would be supported by the middleware.\nThe middleware is currently locatedin the keystone essex repository and was entirely rewritten from the Diablo release to allow support these Swift features :","keywords":["Openstack"],"articleBody":"During the development for OpenStack Essex a lot of work has been done to make Swift working well with the other OpenStack components, this is a list of the work that has been done.\nMIDDLEWARE To make Swift behaving well in the ‘stack’ we had to get a rock solid keystone middleware and make sure most of the features provided by Swift would be supported by the middleware.\nThe middleware is currently locatedin the keystone essex repository and was entirely rewritten from the Diablo release to allow support these Swift features :\n ACL via keystone roles :   Anonymous access via ACL referrer.   Container syncing :   Different reseller prefix :   Special reseller admin account :   S3 emulation :  One thing missing in the middleware is to allow auth overriding, basically it means that when an another middleware wants to take care of the authentication for some request the auth middleware will just let it go and allow the request to continue. Such feature is used for example in the temp_urlmiddleware to allow temporary access/upload to an object. This is projected to be supported in the future.\nAn important thing to keep in mind when you configure your roles is to have a user in a tenant (or account like called in Swift world) acting as an operator. This is controlled by the setting :\nswift_operator_roles\nand by default have the roles swiftoperator and admin. A user needs to have this role to be able to do something in a tenant.\nGLANCE Glance has been updated as well to be able to store images in swift which have a auth server using the 2.0 identity auth.\nNOVA\nNova have the ability to access an objectstore to store images in a store which has been uploaded with the euca-upload-bundle command. Historically nova have shipped with a service called nova-objectstore but the service was buggy and had some security issues. Swift combined with keystone’s s3_token and swift3 middleware now can act as a more reliable and secure objectstore for Nova.\nDEVSTACK support Swift if you add the swift service to the ENABLED_SERVICE variable in your localrc. This is where you want to poke around to see how the configuration is made to have everything playing well together. The only bit that didn’t made for the devstack essex release is to have glance storing images directly in Swift.\nCLI / Client Library Swift CLI and client library (called swift.common.client) has been updated to support auth v2.0 the CLI support now the common OpenStack CLI arguments and environmentto operate against auth server that has 2.0 identity auth.\nWe unfortunately were not in time to add the support for OS_AUTH_TENANT and use the Swift auth v1 syntax where if the user has the form of tenant:user OS_AUTH_TENANT will become tenant and OS_AUTH_USER the user.\nAside of a couple of bit missing we believe Swift should be rock solid to use with your other OpenStack components. There is no excuse to not use Swift as your central object storage component in OpenStack ;-).\n ","wordCount":"505","inLanguage":"en","datePublished":"2012-04-25T15:11:58Z","dateModified":"2012-04-25T15:11:58Z","author":{"@type":"Person","name":"chmouel"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chmouel.com/2012/04/25/swift-integration-with-other-openstack-components-in-essex/"},"publisher":{"@type":"Organization","name":"Chmouel's blog","logo":{"@type":"ImageObject","url":"https://blog.chmouel.com/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.chmouel.com/ accesskey=h title="Chmouel's blog (Alt + H)">Chmouel's blog</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://github.com/chmouel/ title=Github><span>Github</span></a></li><li><a href=https://photos.chmouel.com title=Photos><span>Photos</span></a></li><li><a href=https://app.strava.com/athletes/126695 title=Strava><span>Strava</span></a></li><li><a href=https://twitter.com/chmouel title=Twitter><span>Twitter</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Swift integration with other OpenStack components in Essex.</h1><div class=post-meta><span title="2012-04-25 15:11:58 +0000 UTC">April 25, 2012</span></div></header><div class=post-content><p>During the development for OpenStack Essex a lot of work has been done to make Swift working well with the other OpenStack components, this is a list of the work that has been done.</p><h4 id=middleware><strong>MIDDLEWARE</strong><a hidden class=anchor aria-hidden=true href=#middleware>#</a></h4><p>To make Swift behaving well in the &lsquo;stack&rsquo; we had to get a rock solid keystone middleware and make sure most of the features provided by Swift would be supported by the middleware.</p><p>The middleware is currently located in the keystone essex repository and was entirely rewritten from the Diablo release to allow support these Swift features :</p><ul><li>ACL via keystone roles :</li></ul><ul><li>Anonymous access via ACL referrer.</li></ul><ul><li>Container syncing :</li></ul><ul><li>Different reseller prefix :</li></ul><ul><li>Special reseller admin account :</li></ul><ul><li>S3 emulation :</li></ul><p>One thing missing in the middleware is to allow auth overriding, basically it means that when an another middleware wants to take care of the authentication for some request the auth middleware will just let it go and allow the request to continue. Such feature is used for example in the temp_url middleware to allow temporary access/upload to an object. This is projected to be supported in the future.</p><p>An important thing to keep in mind when you configure your roles is to have a user in a tenant (or account like called in Swift world) acting as an operator. This is controlled by the setting :</p><p><strong>swift_operator_roles</strong></p><p>and by default have the roles <em>swiftoperator</em> and <em>admin</em>. A user needs to have this role to be able to do something in a tenant.</p><h4 id=glance><strong>GLANCE</strong><a hidden class=anchor aria-hidden=true href=#glance>#</a></h4><p>Glance has been updated as well to be able to store images in swift which have a auth server using the 2.0 identity auth.</p><p><strong>NOVA</strong></p><p>Nova have the ability to access an objectstore to store images in a store which has been uploaded with the euca-upload-bundle command. Historically nova have shipped with a service called nova-objectstore but the service was buggy and had some security issues. Swift combined with keystone&rsquo;s s3_token and swift3 middleware now can act as a more reliable and secure objectstore for Nova.</p><h4 id=devstack><strong>DEVSTACK</strong><a hidden class=anchor aria-hidden=true href=#devstack>#</a></h4><p>support Swift if you add the swift service to the ENABLED_SERVICE variable in your localrc. This is where you want to poke around to see how the configuration is made to have everything playing well together. The only bit that didn&rsquo;t made for the devstack essex release is to have glance storing images directly in Swift.</p><h4 id=cli--client-library><strong>CLI / Client Library</strong><a hidden class=anchor aria-hidden=true href=#cli--client-library>#</a></h4><p>Swift CLI and client library (called swift.common.client) has been updated to support auth v2.0 the CLI support now the common OpenStack CLI arguments and environment to operate against auth server that has 2.0 identity auth.</p><p>We unfortunately were not in time to add the support for OS_AUTH_TENANT and use the Swift auth v1 syntax where if the user has the form of tenant:user OS_AUTH_TENANT will become tenant and OS_AUTH_USER the user.</p><p>Aside of a couple of bit missing we believe Swift should be rock solid to use with your other OpenStack components. There is no excuse to not use Swift as your central object storage component in OpenStack ;-).</p><p> </p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chmouel.com/tags/openstack/>Openstack</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.chmouel.com/>Chmouel's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>