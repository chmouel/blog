<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tekton yaml templates and script feature | Chmouel's blog</title><meta name=keywords content="tekton,work"><meta name=description content="Don&rsquo;t you love &ldquo;yaml&rdquo;, yes you do ! or at least that&rsquo;s what the industry told you to love!
When you were in school your teacher told you about &ldquo;XML&rdquo; and how it will solve all the industry problems (and there was many in the late 90s). But you learned that you hate reaching to your &#34;<&#34; and&#34; &#34;>&#34; keys and rather have something else. So then the industry came up with &ldquo;json&rdquo; so computer or yourself can talk to each others, that&rsquo;s nice for computers but actually not so nice for yourself it was actually a lie and was not made for yourself to read and write but only for comptures."><meta name=author content><link rel=canonical href=https://blog.chmouel.com/2020/07/28/tekton-yaml-templates-and-script-feature/><link crossorigin=anonymous href=/assets/css/stylesheet.min.733d0ed34a984bf1936e895c1fb63452db516019da8c1c2e2f044719da64bee0.css integrity="sha256-cz0O00qYS/GTbolcH7Y0UttRYBnajBwuLwRHGdpkvuA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.chmouel.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chmouel.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chmouel.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chmouel.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.chmouel.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Tekton yaml templates and script feature"><meta property="og:description" content="Don&rsquo;t you love &ldquo;yaml&rdquo;, yes you do ! or at least that&rsquo;s what the industry told you to love!
When you were in school your teacher told you about &ldquo;XML&rdquo; and how it will solve all the industry problems (and there was many in the late 90s). But you learned that you hate reaching to your &#34;<&#34; and&#34; &#34;>&#34; keys and rather have something else. So then the industry came up with &ldquo;json&rdquo; so computer or yourself can talk to each others, that&rsquo;s nice for computers but actually not so nice for yourself it was actually a lie and was not made for yourself to read and write but only for comptures."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chmouel.com/2020/07/28/tekton-yaml-templates-and-script-feature/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-28T08:55:07+00:00"><meta property="article:modified_time" content="2020-07-28T08:55:07+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tekton yaml templates and script feature"><meta name=twitter:description content="Don&rsquo;t you love &ldquo;yaml&rdquo;, yes you do ! or at least that&rsquo;s what the industry told you to love!
When you were in school your teacher told you about &ldquo;XML&rdquo; and how it will solve all the industry problems (and there was many in the late 90s). But you learned that you hate reaching to your &#34;<&#34; and&#34; &#34;>&#34; keys and rather have something else. So then the industry came up with &ldquo;json&rdquo; so computer or yourself can talk to each others, that&rsquo;s nice for computers but actually not so nice for yourself it was actually a lie and was not made for yourself to read and write but only for comptures."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chmouel.com/posts/"},{"@type":"ListItem","position":2,"name":"Tekton yaml templates and script feature","item":"https://blog.chmouel.com/2020/07/28/tekton-yaml-templates-and-script-feature/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tekton yaml templates and script feature","name":"Tekton yaml templates and script feature","description":"Don\u0026rsquo;t you love \u0026ldquo;yaml\u0026rdquo;, yes you do ! or at least that\u0026rsquo;s what the industry told you to love!\nWhen you were in school your teacher told you about \u0026ldquo;XML\u0026rdquo; and how it will solve all the industry problems (and there was many in the late 90s). But you learned that you hate reaching to your \u0026quot;\u0026lt;\u0026quot; and\u0026quot; \u0026quot;\u0026gt;\u0026quot; keys and rather have something else. So then the industry came up with \u0026ldquo;json\u0026rdquo; so computer or yourself can talk to each others, that\u0026rsquo;s nice for computers but actually not so nice for yourself it was actually a lie and was not made for yourself to read and write but only for comptures.","keywords":["tekton","work"],"articleBody":"Don’t you love “yaml”, yes you do ! or at least that’s what the industry told you to love!\nWhen you were in school your teacher told you about “XML” and how it will solve all the industry problems (and there was many in the late 90s). But you learned that you hate reaching to your \" and\" \"\" keys and rather have something else. So then the industry came up with “json” so computer or yourself can talk to each others, that’s nice for computers but actually not so nice for yourself it was actually a lie and was not made for yourself to read and write but only for comptures. So then the “industry” came up with yaml, indentation based? you get it and that’s humm all about it, now you are stuck counting whitespaces in a 3000 lines file trying to figure out where goes where….\nAnywoo ranting about computer history is not the purpose of this blog post, like every other cloud native (sigh) component out there tekton is using yaml to let the user describe its operative executions. There is a very nice feature in there (no sarcasm it is really nice!) allowing you to embed “scripts” directly in tasks. Instead of like before where you had to build a container image with your script and run it from tekton, you can now just specify the script embedded directly in your “Task” or “Pipeline”.\nAll good, all good, that’s very nice and dandy but when you start writing a script that goes over 5 lines you are getting into the territory where you have mixed a ~1000 lines script embedded in a 2000 lines of yaml (double sigh).\nYou can come back to the old way, and start to go over the development workflow of :\n“write” - commit - “push” - “build image” = “push” - “update tag” - “start task”\nand realize that you are loosing approximately 40 years of your soul into some boring and repetitive tasks.\nSo now that i am over talking to myself with this way too long preamble here is the real piece of information in this post, a script that like everything in your life workaround the real issue.\nIt’s available here :\nhttps://github.com/chmouel/chmouzies/blob/master/work/tekton-script-template.shThe idea is if you have in your template a tag saying #INSERT filename, it would be replaced by the content of the file, it’s dumb and stupid but make devloping your yaml much more pleasing… so if you have something like :\nthe script with see this and insert the file script.py in your template. It will respect the previous line indentation and add four spaces extra to indent the script and you can have as many INSERT as you want in your template….\nNow you can edit your code in script.py and your yaml template in the yaml template.. win win, separation of concerns, sanity win happy dance and emoji and all…\n","wordCount":"490","inLanguage":"en","datePublished":"2020-07-28T08:55:07Z","dateModified":"2020-07-28T08:55:07Z","author":{"@type":"Person","name":"chmouel"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chmouel.com/2020/07/28/tekton-yaml-templates-and-script-feature/"},"publisher":{"@type":"Organization","name":"Chmouel's blog","logo":{"@type":"ImageObject","url":"https://blog.chmouel.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.chmouel.com/ accesskey=h title="Chmouel's blog (Alt + H)">Chmouel's blog</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://github.com/chmouel/ title=Github><span>Github</span></a></li><li><a href=https://photos.chmouel.com title=Photos><span>Photos</span></a></li><li><a href=https://app.strava.com/athletes/126695 title=Strava><span>Strava</span></a></li><li><a href=https://twitter.com/chmouel title=Twitter><span>Twitter</span></a></li><li><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Tekton yaml templates and script feature</h1><div class=post-meta><span title="2020-07-28 08:55:07 +0000 UTC">July 28, 2020</span>&nbsp;|&nbsp;<a href=https://github.com/chmouel/blog/tree/main/content/posts/2020-07-28-tekton-yaml-templates-and-script-feature.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=post-content><p>Don&rsquo;t you love &ldquo;yaml&rdquo;, yes you do ! or at least that&rsquo;s what the industry told you to love!</p><p>When you were in school your teacher told you about &ldquo;XML&rdquo; and how it will solve all the industry problems (and there was many in the late 90s). But you learned that you hate reaching to your <strong>"&lt;"</strong> and" <strong>">"</strong> keys and rather have something else. So then the industry came up with &ldquo;json&rdquo; so computer or yourself can talk to each others, that&rsquo;s nice for computers but actually not so nice for yourself it was actually a lie and was not made for yourself to read and write but only for comptures. So then the &ldquo;industry&rdquo; came up with <strong>yaml</strong>, indentation based? you get it and that&rsquo;s humm all about it, now you are stuck counting whitespaces in a 3000 lines file trying to figure out where goes where&mldr;.</p><p>Anywoo ranting about computer history is not the purpose of this blog post, like every other cloud native (sigh) component out there tekton is using yaml to let the user describe its operative executions. There is a very nice feature in there (no sarcasm it is really nice!) allowing you to embed &ldquo;scripts&rdquo; directly in tasks. Instead of like before where you had to build a container image with your script and run it from tekton, you can now just specify the script embedded directly in your &ldquo;Task&rdquo; or &ldquo;Pipeline&rdquo;.</p><p>All good, all good, that&rsquo;s very nice and dandy but when you start writing a script that goes over 5 lines you are getting into the territory where you have mixed a ~1000 lines script embedded in a 2000 lines of yaml (double sigh).</p><p>You can come back to the old way, and start to go over the development workflow of :</p><p>&ldquo;write&rdquo; -> commit -> &ldquo;push&rdquo; -> &ldquo;build image&rdquo; => &ldquo;push&rdquo; -> &ldquo;update tag&rdquo; -> &ldquo;start task&rdquo;</p><p>and realize that you are loosing approximately 40 years of your soul into some boring and repetitive tasks.</p><p>So now that i am over talking to myself with this way too long preamble here is the real piece of information in this post, a script that like everything in your life workaround the real issue.</p><p>It&rsquo;s available here :</p><p><a href=https://github.com/chmouel/chmouzies/blob/master/work/tekton-script-template.sh>https://github.com/chmouel/chmouzies/blob/master/work/tekton-script-template.sh</a></p><p>The idea is if you have in your template a tag saying #INSERT filename, it would be replaced by the content of the file, it&rsquo;s dumb and stupid but make devloping your yaml much more pleasing&mldr; so if you have something like :</p><p>the script with see this and insert the file script.py in your template. It will respect the previous line indentation and add four spaces extra to indent the script and you can have as many INSERT as you want in your template&mldr;.</p><p>Now you can edit your code in script.py and your yaml template in the yaml template.. win win, separation of concerns, sanity win happy dance and emoji and all&mldr;</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chmouel.com/tags/tekton/>tekton</a></li><li><a href=https://blog.chmouel.com/tags/work/>work</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.chmouel.com/>Chmouel's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>