<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Using python to drive OpenShift REST API | Chmouel's blog</title><meta name=keywords content="OpenShift"><meta name=description content="I have been meaning to automate my deployment directly from my small python application without having to use the openshift client (oc) directly.
OpenShift use a REST API and the oc client uses it to communicate with the server, you can actually see all the REST operation the oc client is doing if you specify the &ndash;loglevel=7 (it goes to 10 to get even more debug info) :
$ oc --loglevel=7 get pod 2>&amp;1 |head -10 I0919 09:59:20."><meta name=author content><link rel=canonical href=https://blog.chmouel.com/2016/09/19/using-python-to-drive-openshift-rest-api/><link crossorigin=anonymous href=/assets/css/stylesheet.9a18bcc7aea35356ff8ec585fcaf37f8ccd512596b0833c5577cc43f4517b13c.css integrity="sha256-mhi8x66jU1b/jsWF/K83+MzVEllrCDPFV3zEP0UXsTw=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.chmouel.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.chmouel.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.chmouel.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.chmouel.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.chmouel.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Using python to drive OpenShift REST API"><meta property="og:description" content="I have been meaning to automate my deployment directly from my small python application without having to use the openshift client (oc) directly.
OpenShift use a REST API and the oc client uses it to communicate with the server, you can actually see all the REST operation the oc client is doing if you specify the &ndash;loglevel=7 (it goes to 10 to get even more debug info) :
$ oc --loglevel=7 get pod 2>&amp;1 |head -10 I0919 09:59:20."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chmouel.com/2016/09/19/using-python-to-drive-openshift-rest-api/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-09-19T08:19:50+00:00"><meta property="article:modified_time" content="2016-09-19T08:19:50+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using python to drive OpenShift REST API"><meta name=twitter:description content="I have been meaning to automate my deployment directly from my small python application without having to use the openshift client (oc) directly.
OpenShift use a REST API and the oc client uses it to communicate with the server, you can actually see all the REST operation the oc client is doing if you specify the &ndash;loglevel=7 (it goes to 10 to get even more debug info) :
$ oc --loglevel=7 get pod 2>&amp;1 |head -10 I0919 09:59:20."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.chmouel.com/posts/"},{"@type":"ListItem","position":2,"name":"Using python to drive OpenShift REST API","item":"https://blog.chmouel.com/2016/09/19/using-python-to-drive-openshift-rest-api/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Using python to drive OpenShift REST API","name":"Using python to drive OpenShift REST API","description":"I have been meaning to automate my deployment directly from my small python application without having to use the openshift client (oc) directly.\nOpenShift use a REST API and the oc client uses it to communicate with the server, you can actually see all the REST operation the oc client is doing if you specify the \u0026ndash;loglevel=7 (it goes to 10 to get even more debug info) :\n$ oc --loglevel=7 get pod 2\u0026gt;\u0026amp;1 |head -10 I0919 09:59:20.","keywords":["OpenShift"],"articleBody":"I have been meaning to automate my deployment directly from my small python application without having to use the openshift client (oc) directly.\nOpenShift use a REST API and the oc client uses it to communicate with the server, you can actually see all the REST operation the oc client is doing if you specify the –loglevel=7 (it goes to 10 to get even more debug info) :\n$ oc --loglevel=7 get pod 2\u003e\u00261 |head -10 I0919 09:59:20.047350 77328 loader.go:329] Config loaded from file /Users/chmouel/.kube/config I0919 09:59:20.048149 77328 round_trippers.go:296] GET https://openshift:8443/oapi I0919 09:59:20.048158 77328 round_trippers.go:303] Request Headers: I0919 09:59:20.048162 77328 round_trippers.go:306] User-Agent: oc/v1.4.0 (darwin/amd64) openshift/85eb37b I0919 09:59:20.048175 77328 round_trippers.go:306] Authorization: Bearer FOOBAR I0919 09:59:20.048180 77328 round_trippers.go:306] Accept: application/json, */* I0919 09:59:20.095239 77328 round_trippers.go:321] Response Status: 200 OK in 47 milliseconds I0919 09:59:20.096056 77328 round_trippers.go:296] GET https://openshift:8443/version I0919 09:59:20.096078 77328 round_trippers.go:303] Request Headers: I0919 09:59:20.096084 77328 round_trippers.go:306] User-Agent: oc/v1.4.0 (darwin/amd64) openshift/85eb37b I was thinking to come up with my own python rest wrapper since a google quick search didn’t come up with any binding. But since openshift is build on kubernetes and fully compatible with it (i.e: no fork or changes that make it incompatible) it was as easy as using the tools provided for kube.\nThe first project coming up on the google search is pykube and it’s easily installable with pip.\nYou need to provide a kubeconfig that was already setup (with username/passwd) or already identified if it’s token based (i.e: oauth, oid etc) and you can use this example like this :\nimport pykube api = pykube.HTTPClient(pykube.KubeConfig.from_file(\"/Users/chmouel/.kube/config\")) pods = pykube.Pod.objects(api).filter(namespace=\"test\") for x in pods: print(x) see the documentation of pykub on its website\n","wordCount":"275","inLanguage":"en","datePublished":"2016-09-19T08:19:50Z","dateModified":"2016-09-19T08:19:50Z","author":{"@type":"Person","name":"chmouel"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.chmouel.com/2016/09/19/using-python-to-drive-openshift-rest-api/"},"publisher":{"@type":"Organization","name":"Chmouel's blog","logo":{"@type":"ImageObject","url":"https://blog.chmouel.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.chmouel.com/ accesskey=h title="Chmouel's blog (Alt + H)">Chmouel's blog</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://github.com/chmouel/ title=Github><span>Github</span></a></li><li><a href=https://photos.chmouel.com title=Photos><span>Photos</span></a></li><li><a href=https://app.strava.com/athletes/126695 title=Strava><span>Strava</span></a></li><li><a href=https://twitter.com/chmouel title=Twitter><span>Twitter</span></a></li><li><a href=https://redhat.com title=Work><span>Work</span></a></li><li><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Using python to drive OpenShift REST API</h1><div class=post-meta><span title='2016-09-19 08:19:50 +0000 UTC'>September 19, 2016</span>&nbsp;|&nbsp;<a href=https://github.com/chmouel/blog/tree/main/content/posts/2016-09-19-using-python-to-drive-openshift-rest-api.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=post-content><p>I have been meaning to automate my deployment directly from my small python application without having to use the openshift client (oc) directly.</p><p>OpenShift use a REST API and the oc client uses it to communicate with the server, you can actually see all the REST operation the oc client is doing if you specify the &ndash;loglevel=7 (it goes to 10 to get even more debug info) :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ oc --loglevel=7 get pod 2&gt;&amp;1 |head -10
</span></span><span style=display:flex><span>I0919 09:59:20.047350   77328 loader.go:329] Config loaded from file /Users/chmouel/.kube/config
</span></span><span style=display:flex><span>I0919 09:59:20.048149   77328 round_trippers.go:296] GET https://openshift:8443/oapi
</span></span><span style=display:flex><span>I0919 09:59:20.048158   77328 round_trippers.go:303] Request Headers:
</span></span><span style=display:flex><span>I0919 09:59:20.048162   77328 round_trippers.go:306]     User-Agent: oc/v1.4.0 (darwin/amd64) openshift/85eb37b
</span></span><span style=display:flex><span>I0919 09:59:20.048175   77328 round_trippers.go:306]     Authorization: Bearer FOOBAR
</span></span><span style=display:flex><span>I0919 09:59:20.048180   77328 round_trippers.go:306]     Accept: application/json, */*
</span></span><span style=display:flex><span>I0919 09:59:20.095239   77328 round_trippers.go:321] Response Status: 200 OK in 47 milliseconds
</span></span><span style=display:flex><span>I0919 09:59:20.096056   77328 round_trippers.go:296] GET https://openshift:8443/version
</span></span><span style=display:flex><span>I0919 09:59:20.096078   77328 round_trippers.go:303] Request Headers:
</span></span><span style=display:flex><span>I0919 09:59:20.096084   77328 round_trippers.go:306]     User-Agent: oc/v1.4.0 (darwin/amd64) openshift/85eb37b
</span></span></code></pre></div><p>I was thinking to come up with my own python rest wrapper since a google quick search didn&rsquo;t come up with any binding. But since openshift is build on kubernetes and fully compatible with it (i.e: no fork or changes that make it incompatible) it was as easy as using the tools provided for kube.</p><p>The first project coming up on the google search is <a href=https://github.com/kelproject/pykube>pykube</a> and it&rsquo;s easily installable with pip.</p><p>You need to provide a kubeconfig that was already setup (with username/passwd) or already identified if it&rsquo;s token based (i.e: oauth, oid etc) and you can use this example like this :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff79c6>import</span> pykube
</span></span><span style=display:flex><span>api <span style=color:#ff79c6>=</span> pykube<span style=color:#ff79c6>.</span>HTTPClient(pykube<span style=color:#ff79c6>.</span>KubeConfig<span style=color:#ff79c6>.</span>from_file(<span style=color:#f1fa8c>&#34;/Users/chmouel/.kube/config&#34;</span>))
</span></span><span style=display:flex><span>pods <span style=color:#ff79c6>=</span> pykube<span style=color:#ff79c6>.</span>Pod<span style=color:#ff79c6>.</span>objects(api)<span style=color:#ff79c6>.</span>filter(namespace<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;test&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#ff79c6>for</span> x <span style=color:#ff79c6>in</span> pods:
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>print</span>(x)
</span></span></code></pre></div><p>see the documentation of pykub on its <a href=https://github.com/kelproject/pykube>website</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.chmouel.com/tags/openshift/>OpenShift</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.chmouel.com/>Chmouel's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>